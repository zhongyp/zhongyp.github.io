
<!DOCTYPE html>
<html lang="zh-Hans">


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme-color" content="#202020"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  
    <meta name="keywords" content="Spring," />
  

  
    <meta name="description" content="é’Ÿå®‡é¹çš„åšå®¢" />
  
  
  <link rel="icon" type="image/x-icon" href="/logo.png">
  <title>Spring AOP [ DO IT ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
    
      <link rel="stylesheet" href="/css/simple.css">
    
  
</head>

<body>
  <nav class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
  <ul class="pure-menu-list float-r clearfix">
    
      <!-- <li class="pure-menu-item toc-menu pure-menu-has-children pure-menu-allow-hover">
        <a id="menu-main-post" class="pure-menu-link" href="javascript:;">
          <img class="menu-icon" src="/logo.png" alt="MENU">
        </a>
      </li> -->
      <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
        <a id="menu-main" class="pure-menu-link" href="javascript:;">
          <img class="menu-icon" src="/logo.png" alt="MENU">
        </a>
        <ul class="pure-menu-children">
        
          
            <li class="pure-menu-item"><a href="/" class="pure-menu-link">é¦–é¡µ</a></li>
          
          
          
            <li class="pure-menu-item"><a href="/tags" class="pure-menu-link">æ ‡ç­¾</a></li>
          
          
          
            <li class="pure-menu-item"><a href="/search" class="pure-menu-link">æœç´¢</a></li>
          
          
          
            <li class="pure-menu-item"><a href="/about" class="pure-menu-link">å…³äº</a></li>
          
          
      </ul>
      </li>
    
  </ul>
  <a class="pure-menu-heading" href="/">
      <h1 class="title">DO IT</h1>
      <!-- <span>é’Ÿå®‡é¹çš„åšå®¢</span> -->
  </a>
  <!-- 
  <img class="logo" id="logo" src="/logo.png" alt="logo">
   -->
</nav>


  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <article class="post" id="post">
  <header class="post-header text-center">
    <h1 class="title">
      Spring AOP
    </h1>
    
    <time class="time" datetime="2018-10-02T16:00:00.000Z">
      2018-10-03
    </time>
    
    <hr>
  </header>
  <div class="post-content">
    <h2 id="Spring-AOP"><a href="#Spring-AOP" class="headerlink" title="Spring AOP"></a>Spring AOP</h2><p>æœ¬ç¯‡æ–‡ç« ç¿»è¯‘è‡ª<a href="https:www.tutorialspoint.com/spring/aop_with_spring.htm" target="_blank" rel="noopener">AOP with Spring</a>ï¼Œä¸»è¦ä»‹ç»æ˜¯å…³äºAOPçš„æ¦‚å¿µã€‚</p>
<h3 id="Brief-introduction-ï¼ˆç®€ä»‹ï¼‰"><a href="#Brief-introduction-ï¼ˆç®€ä»‹ï¼‰" class="headerlink" title="Brief introduction ï¼ˆç®€ä»‹ï¼‰"></a>Brief introduction ï¼ˆç®€ä»‹ï¼‰</h3><p>One of the key components of Spring Framework is the Aspect oriented programming (AOP) framework. Aspect-Oriented Programming entails breaking down program logic into distinct parts called so-called concerns. The functions that span multiple points of an application are called cross-cutting concerns and these cross-cutting concerns are conceptually separate from the applicationâ€™s business logic. There are various common good examples of aspects like logging, auditing, declarative transactions, security, caching, etc.</p>
<p>The key unit of modularity in OOP is the class, whereas in AOP the unit of modularity is the aspect. Dependency Injection helps you decouple your application objects from each other and AOP helps you decouple cross-cutting concerns from the objects that they affect. AOP is like triggers in programming languages such as Perl, .NET, Java, and others.</p>
<p>Spring AOP module provides interceptors to intercept an application. For example, when a method is executed, you can add extra functionality before or after the method execution.</p>
<p>ç¿»è¯‘ï¼š</p>
<p>AOPé¢å‘åˆ‡é¢ç¼–ç¨‹æ˜¯Springæ¡†æ¶ä¸­çš„æœ€å…³é”®çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚é¢å‘åˆ‡é¢ç¼–ç¨‹éœ€è¦æ‹†åˆ†ç¼–ç é€»è¾‘åˆ°ç§°ä¸ºç‚¹çš„ä¸åŒéƒ¨åˆ†ã€‚ä¸€ä¸ªåœ¨åº”ç”¨ç¨‹åºå†…è·¨è¶Šå¤šä¸ªç‚¹çš„æ–¹æ³•è¢«ç§°ä¸ºæ¨ªåˆ‡ç‚¹ï¼Œè¿™äº›æ¨ªåˆ‡ç‚¹å’Œåº”ç”¨çš„ä¸šåŠ¡é€»è¾‘åœ¨æ¦‚å¿µä¸Šæ˜¯åˆ†å¼€çš„ã€‚ç›®å‰å·²ç»æœ‰å¾ˆå¤šåº”ç”¨åˆ‡é¢çš„ä¾‹å­ï¼Œæ¯”å¦‚æ—¥å¿—ï¼Œå®¡è®¡ï¼Œå£°æ˜å¼äº‹åŠ¡ï¼Œå®‰å…¨ï¼Œç¼“å­˜ç­‰ã€‚</p>
<p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œæ¨¡å—åŒ–çš„å…³é”®å•å…ƒæ˜¯ç±»ï¼Œä½†æ˜¯åœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹ä¸­ï¼Œæ¨¡å—åŒ–å•å…ƒæ˜¯åˆ‡é¢ã€‚ä¾èµ–æ³¨å…¥å¸®åŠ©ä½ å°†åº”ç”¨ä¸­çš„å¯¹è±¡ç›¸äº’è§£è€¦ï¼ŒAOPå¸®åŠ©ä½ å°†æ¨ªåˆ‡ç‚¹ä»å®ƒä»¬ä½œç”¨çš„å¯¹è±¡ä¸­è§£è€¦ã€‚AOPå°±åƒæ˜¯Perl,.NET,Javaæˆ–è€…å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„è§¦å‘å™¨ã€‚</p>
<p>Spring AOPæ¨¡å—æä¾›æ‹¦æˆªåº”ç”¨çš„æ‹¦æˆªå™¨ã€‚ä¸¾ä¸ªğŸŒ°ï¼Œä½ å¯ä»¥åœ¨ä½ è¿è¡Œçš„æ–¹æ³•ä¹‹å‰æˆ–è€…ä¹‹åæ·»åŠ é¢å¤–çš„åŠŸèƒ½æˆ–è€…æ–¹æ³•ã€‚</p>
<h3 id="AOP-Terminologiesï¼ˆAOP-æœ¯è¯­ï¼‰"><a href="#AOP-Terminologiesï¼ˆAOP-æœ¯è¯­ï¼‰" class="headerlink" title="AOP Terminologiesï¼ˆAOP æœ¯è¯­ï¼‰"></a>AOP Terminologiesï¼ˆAOP æœ¯è¯­ï¼‰</h3><h4 id="Aspectï¼ˆåˆ‡é¢ï¼‰"><a href="#Aspectï¼ˆåˆ‡é¢ï¼‰" class="headerlink" title="Aspectï¼ˆåˆ‡é¢ï¼‰"></a>Aspectï¼ˆåˆ‡é¢ï¼‰</h4><p>This is a module which has a set of APIs providing cross-cutting requirements. For example, a logging module would be called AOP aspect for logging. An application can have any number of aspects depending on the requirement.</p>
<p>ç¿»è¯‘ï¼š Aspectä¸€ä¸ªæä¾›æ¨ªåˆ‡ï¼ˆcross-cuttingï¼‰APIsçš„æ¨¡å—ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ—¥å¿—æ¨¡å—è¢«ç§°ä¸ºAOP æ—¥å¿—åˆ‡é¢ã€‚ä¸€ä¸ªåº”ç”¨å¯ä»¥æ ¹æ®éœ€æ±‚æ‹¥æœ‰ä»»ä½•æ•°é‡çš„åˆ‡é¢ã€‚</p>
<h4 id="Join-pointï¼ˆè¿æ¥ç‚¹ï¼‰"><a href="#Join-pointï¼ˆè¿æ¥ç‚¹ï¼‰" class="headerlink" title="Join pointï¼ˆè¿æ¥ç‚¹ï¼‰"></a>Join pointï¼ˆè¿æ¥ç‚¹ï¼‰</h4><p>This represents a point in your application where you can plug-in the AOP aspect. You can also say, it is the actual place in the application where an action will be taken using Spring AOP framework.</p>
<p>ç¿»è¯‘ï¼š åœ¨åº”ç”¨ä¸­å¯ä»¥æ’å…¥AOPåˆ‡é¢çš„åœ°æ–¹å¯è¢«æŠ½è±¡ä¸ºä¸€ä¸ªç‚¹ã€‚ä½ ä¹Ÿå¯ä»¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨åº”ç”¨ä¸­å­˜åœ¨çš„åœ°æ–¹ï¼Œè¿™ä¸ªåœ°æ–¹å°†è¢«Spring AOP æ¡†æ¶æ‰§è¡Œä¸€äº›åŠ¨ä½œã€‚</p>
<p>Adviceï¼ˆé€šçŸ¥ï¼‰</p>
<p>This is the actual action to be taken either before or after the method execution. This is an actual piece of code that is invoked during the program execution by Spring AOP framework.</p>
<p>ç¿»è¯‘ï¼šAdviceæ˜¯ä¸€ä¸ªå®é™…çš„åŠ¨ä½œï¼Œå®ƒå°†åœ¨æ–¹æ³•æ‰§è¡Œå‰å’Œæ–¹æ³•æ‰§è¡Œåæ‰§è¡Œã€‚è¿™æ®µä»£ç é€šè¿‡Spring AOPæ¡†æ¶åœ¨ç¨‹åºè¿è¡Œæ—¶è¢«è°ƒç”¨ã€‚</p>
<h4 id="Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰"><a href="#Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰" class="headerlink" title="Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰"></a>Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰</h4><p>This is a set of one or more join points where an advice should be executed. You can specify pointcuts using expressions or patterns as we will see in our AOP examples.</p>
<p>ç¿»è¯‘ï¼šPointcutæ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿æ¥ç‚¹çš„é›†åˆã€‚æ­£å¦‚æˆ‘ä»¬å°†åœ¨AOPä¾‹å­ä¸­çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼åˆ¶å®šä½ çš„åˆ‡å…¥ç‚¹ã€‚</p>
<h4 id="Introductionï¼ˆå¼•å…¥ï¼‰"><a href="#Introductionï¼ˆå¼•å…¥ï¼‰" class="headerlink" title="Introductionï¼ˆå¼•å…¥ï¼‰"></a>Introductionï¼ˆå¼•å…¥ï¼‰</h4><p>An introduction allows you to add new methods or attributes to the existing classes.</p>
<p>ç¿»è¯‘ï¼šå¼•å…¥å¯ä»¥å…è®¸ä½ æ·»åŠ æ–°çš„æ–¹æ³•æˆ–è€…å±æ€§åˆ°å·²ç»å­˜åœ¨çš„ç±»ä¸­ã€‚</p>
<h4 id="Target-object"><a href="#Target-object" class="headerlink" title="Target object"></a>Target object</h4><p>The object being advised by one or more aspects. This object will always be a proxied object, also referred to as the advised object.</p>
<p>ç¿»è¯‘ï¼šè¿™ä¸ªå¯¹è±¡è¢«ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ‡é¢é€šçŸ¥ã€‚è¿™ä¸ªå¯¹è±¡ä¸€èˆ¬æ˜¯ä»£ç†å¯¹è±¡ï¼Œä½œä¸ºè¢«é€šçŸ¥å¯¹è±¡å¼•ç”¨ã€‚</p>
<h4 id="Weavingï¼ˆç»‡å…¥ï¼‰"><a href="#Weavingï¼ˆç»‡å…¥ï¼‰" class="headerlink" title="Weavingï¼ˆç»‡å…¥ï¼‰"></a>Weavingï¼ˆç»‡å…¥ï¼‰</h4><p>Weaving is the process of linking aspects with other application types or objects to create an advised object. This can be done at compile time, load time, or at runtime.</p>
<p>ç¿»è¯‘ï¼šç»‡å…¥æ˜¯é“¾æ¥åˆ‡é¢å’Œå…¶ä»–åº”ç”¨ç±»å‹æˆ–è€…å¯¹è±¡æ¥åˆ›å»ºé€šçŸ¥å¯¹è±¡çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥åœ¨ç¼–è¯‘ã€åŠ è½½æˆ–è€…æ‰§è¡ŒæœŸé—´è¿›è¡Œã€‚</p>
<h3 id="Types-of-Advice"><a href="#Types-of-Advice" class="headerlink" title="Types of Advice"></a>Types of Advice</h3><p>Spring aspects can work with five kinds of advice mentioned as follows.<br>ç¿»è¯‘ï¼šSpring åˆ‡é¢å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æåˆ°çš„äº”ç§advice</p>
<ul>
<li><p>before: Run advice before a method execution.</p>
</li>
<li><p>after: Run advice after a method execution.</p>
</li>
<li><p>after-returning: Run advice after the a method execution only if method completes successfully.</p>
</li>
<li><p>after-throwing: Run advice after the method execution only if method exits by throwing an exception.</p>
</li>
<li><p>around: Run advice before and after the advised method is invoked.</p>
</li>
</ul>
<h3 id="Custom-Aspects-Implementation-è‡ªå®šä¹‰æ¥å£å®ç°"><a href="#Custom-Aspects-Implementation-è‡ªå®šä¹‰æ¥å£å®ç°" class="headerlink" title="Custom Aspects Implementation(è‡ªå®šä¹‰æ¥å£å®ç°)"></a>Custom Aspects Implementation(è‡ªå®šä¹‰æ¥å£å®ç°)</h3><p>XML Schema basedï¼ˆåŸºäºXMLæ¨¡å¼ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http:www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http:www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:aop=&quot;http:www.springframework.org/schema/aop&quot;</span><br><span class="line">       xmlns:tx=&quot;http:www.springframework.org/schema/tx&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http:www.springframework.org/schema/beans</span><br><span class="line">        http:www.springframework.org/schema/beans/spring-beans-4.2.xsd</span><br><span class="line">        http:www.springframework.org/schema/aop</span><br><span class="line">        http:www.springframework.org/schema/aop/spring-aop-4.2.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- ä¸šåŠ¡é€»è¾‘ç±»--AOPè¿æ¥ç‚¹ --&gt;</span><br><span class="line">    &lt;bean id=&quot;aopTest&quot; class=&quot;com.zhongyp.zen.service.aop.AOPTestService&quot; /&gt;</span><br><span class="line">    &lt;!--AOPåˆ‡é¢--&gt;</span><br><span class="line">    &lt;bean id=&quot;timeHandler&quot; class=&quot;com.zhongyp.zen.service.handler.TimeHandler&quot; /&gt;</span><br><span class="line">    &lt;!--AOPåˆ‡é¢--&gt;</span><br><span class="line">    &lt;bean id=&quot;printHandler&quot; class=&quot;com.zhongyp.zen.service.handler.PrintHandler&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;aop:aspectj-autoproxy /&gt;</span><br><span class="line">    &lt;aop:config&gt;</span><br><span class="line">        &lt;!-- pointcutåˆ‡å…¥ç‚¹ï¼ˆAOPè¿æ¥ç‚¹çš„é›†åˆï¼‰--&gt;</span><br><span class="line">        &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(* com.zhongyp.zen.service.*.*.*(..))&quot; /&gt;</span><br><span class="line">        &lt;!-- åˆ‡é¢ --&gt;</span><br><span class="line">        &lt;aop:aspect id=&quot;time&quot; ref=&quot;timeHandler&quot;&gt;</span><br><span class="line">            &lt;!-- AOP Advice --&gt;</span><br><span class="line">            &lt;aop:before method=&quot;printStartTime&quot; pointcut-ref=&quot;pointcut&quot; /&gt;</span><br><span class="line">            &lt;aop:after method=&quot;printEndTime&quot; pointcut-ref=&quot;pointcut&quot; /&gt;</span><br><span class="line">        &lt;/aop:aspect&gt;</span><br><span class="line">        &lt;aop:aspect id=&quot;print&quot; ref=&quot;printHandler&quot;&gt;</span><br><span class="line">            &lt;aop:after-returning method=&quot;printString&quot; pointcut-ref=&quot;pointcut&quot;&gt;&lt;/aop:after-returning&gt;</span><br><span class="line">        &lt;/aop:aspect&gt;</span><br><span class="line">    &lt;/aop:config&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>@AspectJ basedï¼ˆåŸºäºåˆ‡é¢æ³¨è§£ï¼‰</p>
<p>æ³¨è§£æ–¹å¼å¯ä»¥å°†ä¸Šè¿°xmlé…ç½®ä»¥æ³¨è§£çš„å½¢å¼é…ç½®ä¸€ä¸‹ï¼Œæˆ‘è¿™é‡Œåªæ˜¯ç»™å‡ºä¸€ä¸ªæ ·ä¾‹ï¼Œå…¶ä»–çš„è¿˜éœ€è¯»è€…è‡ªå·±å®è·µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Aspect</span><br><span class="line">@Component(&quot;logHandler&quot;)</span><br><span class="line">public class LogHandler &#123;</span><br><span class="line">    @Pointcut(&quot;execution(* com.zhongyp.zen.service.*.*.*(..))&quot;)</span><br><span class="line">    private void hehe()&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    @Before(&quot;hehe()&quot;)</span><br><span class="line">    public void doBefore()&#123;</span><br><span class="line">        System.out.println(&quot;ä¸ºæ¯›å›½åº†è¦åŠ ç­ï¼ï¼ï¼ï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  </div>
  <div class="post-tags">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li></ul>
  </div>
</article>
  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>ã€ˆ </span>
          <a href="/2018/04/02/mysql/2018-04-02-MySQL/" rel="next" title="é«˜æ€§èƒ½MySQL -- æ‘˜è‡ªã€Šé«˜æ€§èƒ½MySQLç¬¬ä¸‰ç‰ˆã€‹">
          é«˜æ€§èƒ½MySQL -- æ‘˜è‡ªã€Šé«˜æ€§èƒ½MySQLç¬¬ä¸‰ç‰ˆã€‹
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
        
          <a href="/2018/10/23/utils/2018-10-23-git/" rel="prev" title="Gitå¸¸ç”¨å‘½ä»¤æ€»ç»“">
            Gitå¸¸ç”¨å‘½ä»¤æ€»ç»“
          </a>
          <span>ã€‰</span>
        
      </div>
    </div>
  


  <div id="toc" class="toc-article">
    <strong class="toc-title">ç›®å½•</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-AOP"><span class="toc-text">Spring AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Brief-introduction-ï¼ˆç®€ä»‹ï¼‰"><span class="toc-text">Brief introduction ï¼ˆç®€ä»‹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP-Terminologiesï¼ˆAOP-æœ¯è¯­ï¼‰"><span class="toc-text">AOP Terminologiesï¼ˆAOP æœ¯è¯­ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Aspectï¼ˆåˆ‡é¢ï¼‰"><span class="toc-text">Aspectï¼ˆåˆ‡é¢ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Join-pointï¼ˆè¿æ¥ç‚¹ï¼‰"><span class="toc-text">Join pointï¼ˆè¿æ¥ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰"><span class="toc-text">Pointcutï¼ˆåˆ‡å…¥ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Introductionï¼ˆå¼•å…¥ï¼‰"><span class="toc-text">Introductionï¼ˆå¼•å…¥ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Target-object"><span class="toc-text">Target object</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weavingï¼ˆç»‡å…¥ï¼‰"><span class="toc-text">Weavingï¼ˆç»‡å…¥ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Types-of-Advice"><span class="toc-text">Types of Advice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Aspects-Implementation-è‡ªå®šä¹‰æ¥å£å®ç°"><span class="toc-text">Custom Aspects Implementation(è‡ªå®šä¹‰æ¥å£å®ç°)</span></a></li></ol></li></ol>
  </div>



    </div>

    

  </div>

  <footer class="footer text-center">
    <div id="bottom-inner">

      <a href="http://programer.group" target="_blank">ä¸»ç«™</a> |
      <a href="http://zhongyp.me">DO IT</a> |
      <a href="https://github.com/zhongyp" target="_blank">GitHub</a> |
      <a href="http://hexo.io" target="_blank">Hexo</a> |
      <a href="https://github.com/zhongyp/hexo-theme-simple" target="_blank">Theme simple</a> |
      <a href="https://github.com/microacup/hexo-theme-micorb" target="_blank">Base on theme microb</a>
    </div>
  </footer>

  

<script>
  (function(window, document, undefined) {

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

    var hearts = [];
    window.requestAnimationFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();
    init();

    function init() {
      css(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
      attachEvent();
      gameloop();
      addMenuEvent();
    }

    function gameloop() {
      for (var i = 0; i < hearts.length; i++) {
        if (hearts[i].alpha <= 0) {
          document.body.removeChild(hearts[i].el);
          hearts.splice(i, 1);
          continue;
        }
        hearts[i].y--;
        hearts[i].scale += 0.004;
        hearts[i].alpha -= 0.013;
        hearts[i].el.style.cssText = "left:" + hearts[i].x + "px;top:" + hearts[i].y + "px;opacity:" + hearts[i].alpha + ";transform:scale(" + hearts[i].scale + "," + hearts[i].scale + ") rotate(45deg);background:" + hearts[i].color;
      }
      requestAnimationFrame(gameloop);
    }

    /**
     * ç»™logoè®¾ç½®ç‚¹å‡»äº‹ä»¶
     *
     * - å›åˆ°é¡¶éƒ¨
     * - å‡ºç°çˆ±å¿ƒ
     */
    function attachEvent() {
      var old = typeof window.onclick === "function" && window.onclick;
      var logo = document.getElementById("logo");
      if (logo) {
        logo.onclick = function(event) {
          returnTop();
          old && old();
          createHeart(event);
        }
      }

    }

    function createHeart(event) {
      var d = document.createElement("div");
      d.className = "heart";
      hearts.push({
        el: d,
        x: event.clientX - 5,
        y: event.clientY - 5,
        scale: 1,
        alpha: 1,
        color: randomColor()
      });
      document.body.appendChild(d);
    }

    function css(css) {
      var style = document.createElement("style");
      style.type = "text/css";
      try {
        style.appendChild(document.createTextNode(css));
      } catch (ex) {
        style.styleSheet.cssText = css;
      }
      document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor() {
      // return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";
      return "#F44336";
    }

    function addMenuEvent() {
      // var menu = document.getElementById('menu-main-post');
      // if (menu) {
      //   var toc = document.getElementById('toc');
      //   if (toc) {
      //     menu.onclick = function() {
      //       if (toc) {
      //         if (toc.style.display == 'block') {
      //           toc.style.display = 'none';
      //         } else {
      //           toc.style.display = 'block';
      //         }
      //       }
      //     };
      //   } else {
      //     menu.style.display = 'none';
      //   }
      // }
    }

  })(window, document);
</script>


  



</body>
</html>
